<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nombre del Proyecto - TaskFlow</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>

<body>

    <header class="header project-header">
        <a href="index.html">
            <img src="logo.png" class="logo-rex" alt="Logo Rex">
        </a>

        <div class="search-bar project-search-bar">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Buscador en el proyecto...">
        </div>
        <div class="member-interaction-area" id="memberListContainer">
            <img src="miembros.png" class="miembros" alt="Miembros del equipo"><i
                class="fas fa-plus fa-lg mas-miembros"></i>
        </div>
        <div class="project-user-actions">
            <button class="btn primary-btn btn-small" onclick="openInviteMemberModal()">
                Invitar miembro
            </button>
            <a href="seguimientoTareas.html" class="btn secondary-btn btn-small">
                Seguimiento de tareas
            </a>
        </div>
        <div class="actions project-user-actions">
            <i class="fas fa-bell notification-icon" style="scale: 1.3; margin-right: 25px;"
                onclick="openNotificationPopover()"></i> <a href="#" class="profile-icon" title="Mi Perfil">
                <i class="fas fa-user-circle" style="scale: 3;"></i>
            </a>
        </div>
    </header>

    <main class="main-content kanban-board-container">

        <div class="kanban-board" id="kanbanBoard">

            <div class="kanban-column" data-status="PENDIENTES">
                <div class="column-header">
                    <h3>PENDIENTES</h3>
                    <div class="column-menu">
                        <i class="fas fa-ellipsis-h"></i>
                    </div>
                </div>
                <div class="column-content">

                    <div class="kanban-card etiqueta-amarilla" onclick="openTaskModal()">
                        <div class="card-image"><img src="LOTAD.jpg"></div>
                        <div class="card-title-kanban">Bienvenida</div>
                    </div>

                    <button class="btn add-item-btn" onclick="openAddItemModal('PENDIENTES')">
                        <i class="fas fa-plus"></i> Añadir item
                    </button>
                </div>
            </div>

            <div class="kanban-column" data-status="EN PROCESO">
                <div class="column-header">
                    <h3>EN PROCESO</h3>
                    <div class="column-menu">
                        <i class="fas fa-ellipsis-h"></i>
                    </div>
                </div>
                <div class="column-content">
                    <button class="btn add-item-btn" onclick="openAddItemModal('EN PROCESO')">
                        <i class="fas fa-plus"></i> Añadir item
                    </button>
                </div>
            </div>
            <div class="kanban-column" data-status="REVISIÓN">
                <div class="column-header">
                    <h3>REVISIÓN</h3>
                    <div class="column-menu">
                        <i class="fas fa-ellipsis-h"></i>
                    </div>
                </div>
                <div class="column-content">
                    <button class="btn add-item-btn" onclick="openAddItemModal('REVISIÓN')">
                        <i class="fas fa-plus"></i> Añadir item
                    </button>
                </div>
            </div>
            <div class="kanban-column" data-status="COMPLETADO">
                <div class="column-header">
                    <h3>COMPLETADO</h3>
                    <div class="column-menu">
                        <i class="fas fa-ellipsis-h"></i>
                    </div>
                </div>
                <div class="column-content">
                    <button class="btn add-item-btn" onclick="openAddItemModal('COMPLETADO')">
                        <i class="fas fa-plus"></i> Añadir item
                    </button>
                </div>
            </div>
            <div class="add-column-placeholder">
                <button class="btn add-column-btn mas-columnas" onclick="openAddColumnModal()">
                    <i class="fas fa-plus fa-lg"></i>
                </button>
            </div>

        </div>
    </main>

    <div id="addItemModal" class="modal-overlay">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h2><i class="fas fa-tasks"></i> Añadir Nueva Tarea</h2>
                <button class="modal-close-btn" onclick="closeAddItemModal()">&times;</button>
            </div>
            <div class="modal-body add-item-form-grid">

                <div class="form-left-col">
                    <div class="input-group">
                        <label for="task-name">Nombre de la Tarea</label>
                        <div class="input-with-icon">
                            <input type="text" id="task-name" placeholder="Escribe un nombre..." required>
                        </div>
                    </div>

                    <div class="tag-controls">
                        <button class="btn secondary-btn" id="toggleTagDropdown" onclick="toggleTagDropdown()">
                            <i class="fas fa-tag"></i> Añadir etiqueta
                        </button>

                        <div class="tag-color-dropdown" id="tagColorDropdown">
                            <div class="color-option tag-rojo" data-color="Rojo" title="Rojo"></div>
                            <div class="color-option tag-azul" data-color="Azul" title="Azul"></div>
                            <div class="color-option tag-verde" data-color="Verde" title="Verde"></div>
                            <div class="color-option tag-amarillo" data-color="Amarillo" title="Amarillo"></div>
                            <div class="color-option tag-morado" data-color="Morado" title="Morado"></div>
                        </div>
                    </div>
                </div>

                <div class="image-upload-area">
                    <label for="task-image" class="image-upload-label">
                        <i class="fas fa-camera"></i> Añadir Imagen (Opcional)
                    </label>
                    <input type="file" id="task-image" accept="image/*" style="display: none;">
                    <div class="image-placeholder">
                        <i class="fas fa-image fa-3x"></i>
                        <span>Arrastra o haz clic para subir una imagen</span>
                    </div>
                </div>

            </div>
            <div class="modal-footer" style="padding-top: 20px;">
                <button class="btn primary-btn" onclick="console.log('Crear Tarea')">
                    Crear Tarea
                </button>
            </div>
        </div>
    </div>

    <div id="inviteMemberModal" class="modal-overlay">
        <div class="modal-content small-modal">
            <div class="modal-header">
                <h2><i class="fas fa-user-plus"></i> Invitar Miembro</h2>
                <button class="modal-close-btn" onclick="closeInviteMemberModal()">&times;</button>
            </div>
            <div class="modal-body">

                <div class="input-group">
                    <label for="invite-email">Invitar por Correo Electrónico</label>
                    <div class="input-with-icon">
                        <i class="fas fa-at"></i>
                        <input type="email" id="invite-email" placeholder="Correo del usuario existente..." required>
                    </div>
                </div>

                <button class="btn primary-btn full-width-btn"
                    onclick="console.log('Invitación enviada a ' + document.getElementById('invite-email').value)">
                    Enviar Invitación
                </button>

                <div class="separator-text">O</div>

                <p style="margin-bottom: 10px; font-weight: 600; font-size: 0.9rem;">Invitar mediante Enlace:</p>
                <div class="invite-link-group">
                    <span id="inviteLink" class="invite-link-text">https://enlace+invitacion...</span>
                    <button class="copy-btn" onclick="copyInviteLink()">
                        <i class="fas fa-copy"></i> Copiar
                    </button>
                </div>

                <p style="font-size: 0.85rem; color: var(--secondary-text); text-align: center;">Comparte este enlace
                    único para que el usuario se una directamente al proyecto.</p>

            </div>
        </div>
    </div>

    <div class="notification-popover" id="notificationPopover">
        <div class="popover-header">
            <h3>Notificaciones</h3>
            <span class="close-popover-btn" onclick="closeNotificationPopover()">&times;</span>
        </div>
        <div class="popover-body">
            <div class="notification-item">
                <span class="member-avatar avatar-cs">CS</span>
                <p class="notification-text">
                    <span class="notification-username">Christian Solís</span> ha creado la columna
                    "Completado".
                </p>
            </div>
            <div class="notification-item">
                <span class="member-avatar avatar-ja">JA</span>
                <p class="notification-text">
                    <span class="notification-username">Juan Andres</span> te ha asignado la tarea
                    "Diseño de wireframes".
                </p>
            </div>
            <div class="notification-item">
                <span class="member-avatar avatar-ma">MA</span>
                <p class="notification-text">
                    <span class="notification-username">Mohamed Ali</span> movió la tarea "Desarrollo" a
                    "En Progreso".
                </p>
            </div>
            <div class="notification-item">
                <span class="member-avatar avatar-jl">JL</span>
                <p class="notification-text">
                    <span class="notification-username">Jessy Lopez</span> comentó en la tarea
                    "Preparación de la demo".
                </p>
            </div>

            <a href="#" class="view-all-link">Ver todas las notificaciones</a>
        </div>
    </div>

    <div id="taskModal" class="task-modal-overlay" style="display:none;">
        <div class="task-modal-content">

            <button class="close-modal-btn" onclick="closeTaskModal()">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
                </svg>
            </button>

            <div class="modal-header-task">
                <h2 id="modal-task-title">Bienvenida</h2>
            </div>

            <div class="modal-body-task">
                <div class="modal-main-section">
                    <h3 class="modal-section-title">Descripción</h3>
                    <textarea id="modal-task-description" class="modal-text-area"
                        placeholder="añadir descripción de la tarea..."
                        style="width: 100%; resize: vertical;"></textarea>
                    <h3 class="modal-section-title">Comentarios</h3>
                    <textarea class="modal-text-area"
                        placeholder="añade un comentario a la tarea o menciona con @usuario..."
                        style="width: 100%; resize: vertical;"></textarea>
                </div>

                <div class="modal-sidebar">
                    <div class="input-group image-input-group-tarea">
                        <div class="image-preview-tarea" id="imagePreview" style="cursor: pointer;">
                            <img id="previewImage" src="LOTAD.jpg" alt="Vista previa de la imagen" style="width: 200px; margin-left: 20px;">
                        </div>
                        <input type="file" id="projectImageInput" accept="image/*" style="display: none;">
                    </div>

                    <button class="sidebar-action-item">
                        Asignar tarea
                    </button>

                    <div class="sidebar-info-box" id="modal-task-assignee">
                        Nadie tiene asignada esta tarea...
                    </div>

                    <button class="sidebar-action-item">
                        Fecha límite
                    </button>
                </div>
            </div>

        </div>
    </div>

    <div id="memberListModal" class="modal-overlay">
        <div class="modal-content small-modal">
            <div class="modal-header">
                <h2><i class="fas fa-users"></i> Miembros del Proyecto</h2>
                <button class="modal-close-btn" onclick="closeMemberListModal()">&times;</button>
            </div>
            <div class="modal-body">

                <div class="member-list-item">
                    <span class="member-avatar avatar-cs">CS</span>
                    <div class="member-info">
                        <div class="member-name">Christian Solís</div>
                        <div class="member-role" id="role-cs">Administrador</div>
                    </div>
                    <div class="member-actions">
                        <button class="role-dropdown-btn" onclick="toggleRoleDropdown('dropdown-cs')">
                            Rol <i class="fas fa-caret-down"></i>
                        </button>
                        <div class="role-dropdown-content" id="dropdown-cs">
                            <a href="#" onclick="selectRole('Christian Solís', 'Administrador', 'role-cs', event)"
                                class="current-role">Administrador</a>
                            <a href="#"
                                onclick="selectRole('Christian Solís', 'Gestor de proyecto', 'role-cs', event)">Gestor
                                de proyecto</a>
                            <a href="#"
                                onclick="selectRole('Christian Solís', 'Trabajador', 'role-cs', event)">Trabajador</a>
                            <a href="#"
                                onclick="selectRole('Christian Solís', 'Colaborador', 'role-cs', event)">Colaborador</a>
                        </div>
                    </div>
                </div>

                <div class="member-list-item">
                    <span class="member-avatar avatar-ja">JA</span>
                    <div class="member-info">
                        <div class="member-name">Juan Andres</div>
                        <div class="member-role" id="role-ja">Colaborador</div>
                    </div>
                    <div class="member-actions">
                        <button class="role-dropdown-btn" onclick="toggleRoleDropdown('dropdown-ja')">
                            Rol <i class="fas fa-caret-down"></i>
                        </button>
                        <div class="role-dropdown-content" id="dropdown-ja">
                            <a href="#"
                                onclick="selectRole('Juan Andres', 'Administrador', 'role-ja', event)">Administrador</a>
                            <a href="#"
                                onclick="selectRole('Juan Andres', 'Gestor de proyecto', 'role-ja', event)">Gestor de
                                proyecto</a>
                            <a href="#"
                                onclick="selectRole('Juan Andres', 'Trabajador', 'role-ja', event)">Trabajador</a>
                            <a href="#" onclick="selectRole('Juan Andres', 'Colaborador', 'role-ja', event)"
                                class="current-role">Colaborador</a>
                        </div>
                    </div>
                </div>

                <div class="member-list-item">
                    <span class="member-avatar avatar-jl">JL</span>
                    <div class="member-info">
                        <div class="member-name">Jessy Lopez</div>
                        <div class="member-role" id="role-jl">Trabajador</div>
                    </div>
                    <div class="member-actions">
                        <button class="role-dropdown-btn" onclick="toggleRoleDropdown('dropdown-jl')">
                            Rol <i class="fas fa-caret-down"></i>
                        </button>
                        <div class="role-dropdown-content" id="dropdown-jl">
                            <a href="#"
                                onclick="selectRole('Jessy Lopez', 'Administrador', 'role-jl', event)">Administrador</a>
                            <a href="#"
                                onclick="selectRole('Jessy Lopez', 'Gestor de proyecto', 'role-jl', event)">Gestor de
                                proyecto</a>
                            <a href="#" onclick="selectRole('Jessy Lopez', 'Trabajador', 'role-jl', event)"
                                class="current-role">Trabajador</a>
                            <a href="#"
                                onclick="selectRole('Jessy Lopez', 'Colaborador', 'role-jl', event)">Colaborador</a>
                        </div>
                    </div>
                </div>

                <div class="member-list-item">
                    <span class="member-avatar avatar-ma">MA</span>
                    <div class="member-info">
                        <div class="member-name">Mohamed Ali</div>
                        <div class="member-role" id="role-ma">Gestor de proyecto</div>
                    </div>
                    <div class="member-actions">
                        <button class="role-dropdown-btn" onclick="toggleRoleDropdown('dropdown-ma')">
                            Rol <i class="fas fa-caret-down"></i>
                        </button>
                        <div class="role-dropdown-content" id="dropdown-ma">
                            <a href="#"
                                onclick="selectRole('Mohamed Ali', 'Administrador', 'role-ma', event)">Administrador</a>
                            <a href="#" onclick="selectRole('Mohamed Ali', 'Gestor de proyecto', 'role-ma', event)"
                                class="current-role">Gestor de proyecto</a>
                            <a href="#"
                                onclick="selectRole('Mohamed Ali', 'Trabajador', 'role-ma', event)">Trabajador</a>
                            <a href="#"
                                onclick="selectRole('Mohamed Ali', 'Colaborador', 'role-ma', event)">Colaborador</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="text-align: right; padding-top: 20px;">
                <button class="btn primary-btn" onclick="openInviteMemberModal(); closeMemberListModal();">
                    Invitar Nuevo Miembro
                </button>
            </div>
        </div>
    </div>

    <div id="addColumnModal" class="modal-overlay">
        <div class="modal-content small-modal">
            <div class="modal-header">
                <h2><i class="fas fa-columns"></i> Crear Nueva Columna</h2>
                <button class="modal-close-btn" onclick="closeAddColumnModal()">&times;</button>
            </div>
            <div class="modal-body">

                <div class="input-group">
                    <label for="column-name">Nombre de la Columna</label>
                    <div class="input-with-icon">
                        <i class="fas fa-tag"></i>
                        <input type="text" id="column-name" placeholder="Ej: Control de Calidad" required>
                    </div>
                </div>

                <div class="input-group">
                    <label>Color de la Etiqueta</label>
                    <div class="color-palette-grid">
                        <div class="color-option-column selected" data-color="#4F46E5"
                            onclick="selectColumnColor(this, '#4F46E5')" style="background-color: #4F46E5;"></div>
                        <div class="color-option-column" data-color="#10B981"
                            onclick="selectColumnColor(this, '#10B981')" style="background-color: #10B981;"></div>
                        <div class="color-option-column" data-color="#F59E0B"
                            onclick="selectColumnColor(this, '#F59E0B')" style="background-color: #F59E0B;"></div>
                        <div class="color-option-column" data-color="#EF4444"
                            onclick="selectColumnColor(this, '#EF4444')" style="background-color: #EF4444;"></div>

                        <div class="color-option-column" data-color="#06B6D4"
                            onclick="selectColumnColor(this, '#06B6D4')" style="background-color: #06B6D4;"></div>
                        <div class="color-option-column" data-color="#8B5CF6"
                            onclick="selectColumnColor(this, '#8B5CF6')" style="background-color: #8B5CF6;"></div>
                        <div class="color-option-column" data-color="#64748B"
                            onclick="selectColumnColor(this, '#64748B')" style="background-color: #64748B;"></div>
                        <div class="color-option-column" data-color="#F97316"
                            onclick="selectColumnColor(this, '#F97316')" style="background-color: #F97316;"></div>

                        <div class="color-option-column" data-color="#EC4899"
                            onclick="selectColumnColor(this, '#EC4899')" style="background-color: #EC4899;"></div>
                        <div class="color-option-column" data-color="#84CC16"
                            onclick="selectColumnColor(this, '#84CC16')" style="background-color: #84CC16;"></div>
                        <div class="color-option-column" data-color="#0F766E"
                            onclick="selectColumnColor(this, '#0F766E')" style="background-color: #0F766E;"></div>
                        <div class="color-option-column" data-color="#3B82F6"
                            onclick="selectColumnColor(this, '#3B82F6')" style="background-color: #3B82F6;"></div>
                    </div>
                </div>

                <div class="input-group selected-color-display">
                    <label>Color Personalizado:</label>
                    <div class="input-with-icon" style="flex-grow: 1; display: flex; align-items: center;">
                        <input type="color" id="custom-column-color" onchange="selectCustomColumnColor(this.value)"
                            value="#4F46E5"
                            style="width: 40px; height: 35px; border: 1px solid var(--border-color); border-radius: 6px; padding: 0;">
                        <input type="text" id="column-color-text-input" value="#4F46E5" readonly
                            style="flex-grow: 1; border: none; background: transparent; padding-left: 10px; color: var(--main-text);">
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button class="btn primary-btn" onclick="createNewColumn()">
                    Crear Columna
                </button>
            </div>
        </div>
    </div>

    <script>
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        const addItemModal = document.getElementById('addItemModal');
        const inviteMemberModal = document.getElementById('inviteMemberModal');
        const taskModal = document.getElementById('taskModal');
        const memberListModal = document.getElementById('memberListModal');
        const addColumnModal = document.getElementById('addColumnModal'); 

        const memberListContainer = document.getElementById('memberListContainer');
        const notificationPopover = document.getElementById('notificationPopover');

        let currentSelectedColor = '#4F46E5'; 
        let isNotificationPopoverOpen = false;

        if (memberListContainer) {
            memberListContainer.addEventListener('click', openMemberListModal);
        }

        function openModal(modal) {
            if (modal !== notificationPopover) {
                closeNotificationPopover(false);
            }
            if (modal) {
                modal.style.display = 'flex';
                document.body.classList.add('modal-open');
            }
        }

        const imagePreview = document.getElementById('imagePreview');
        const projectImageInput = document.getElementById('projectImageInput');

        imagePreview.addEventListener('click', () => {
            projectImageInput.click();
        });

        function closeModal(modal) {
            if (modal) {
                modal.style.display = 'none';

                const anyModalOpen = [addItemModal, inviteMemberModal, memberListModal, addColumnModal]
                    .some(m => m && m.style.display === 'flex');

                if (!anyModalOpen) {
                    document.body.classList.remove('modal-open');
                }
            }
        }

        function openAddItemModal(status) {
            console.log(`Abriendo modal para añadir item en la columna: ${status}`);
            openModal(addItemModal);
        }
        function closeAddItemModal() {
            closeModal(addItemModal);
        }

        function openInviteMemberModal() {
            openModal(inviteMemberModal);
        }
        function closeInviteMemberModal() {
            closeModal(inviteMemberModal);
        }

        function openMemberListModal() {
            console.log("Abriendo modal de Lista de Miembros");
            openModal(memberListModal);
        }
        function closeMemberListModal() {
            closeModal(memberListModal);
        }

        function openNotificationPopover() {
            if (isNotificationPopoverOpen) {
                closeNotificationPopover();
            } else {
                closeAllRoleDropdowns();
                notificationPopover.style.display = 'flex';
                isNotificationPopoverOpen = true;
            }
        }
        function closeNotificationPopover() {
            if (notificationPopover.style.display === 'flex') {
                notificationPopover.style.display = 'none';
                isNotificationPopoverOpen = false;
            }
        }

        function openAddColumnModal() {
            currentSelectedColor = '#4F46E5';
            const colorInput = document.getElementById('custom-column-color');
            const colorText = document.getElementById('column-color-text-input');

            if (colorInput) colorInput.value = currentSelectedColor;
            if (colorText) colorText.value = currentSelectedColor;

            document.querySelectorAll('.color-option-column').forEach(el => el.classList.remove('selected'));
            const defaultColorOption = document.querySelector('.color-option-column[data-color="#4F46E5"]');
            if (defaultColorOption) defaultColorOption.classList.add('selected');

            openModal(addColumnModal);
        }

        function closeAddColumnModal() {
            closeModal(addColumnModal);
        }

        function selectColumnColor(element, color) {
            document.querySelectorAll('.color-option-column').forEach(el => {
                el.classList.remove('selected');
            });

            element.classList.add('selected');

            currentSelectedColor = color;
            document.getElementById('custom-column-color').value = color;
            document.getElementById('column-color-text-input').value = color;
        }

        function selectCustomColumnColor(color) {
            document.querySelectorAll('.color-option-column').forEach(el => {
                el.classList.remove('selected');
            });

            currentSelectedColor = color;
            document.getElementById('column-color-text-input').value = color;
        }

        function createNewColumn() {
            const columnName = document.getElementById('column-name').value.trim();
            const columnColor = currentSelectedColor;

            if (columnName.length === 0) {
                console.error("El nombre de la columna no puede estar vacío (solo diseño).");
                const nameInput = document.getElementById('column-name');
                nameInput.style.border = '2px solid #EF4444';
                setTimeout(() => nameInput.style.border = '1px solid var(--border-color)', 2000);
                return;
            }

            console.log(`Simulación de creación de nueva columna: ${columnName} con color ${columnColor}. (NO se añade al DOM)`);

            closeAddColumnModal();
            document.getElementById('column-name').value = '';
        }

        function copyInviteLink() {
            const linkElement = document.getElementById('inviteLink');
            const linkText = linkElement.textContent;

            const textarea = document.createElement('textarea');
            textarea.value = linkText;
            document.body.appendChild(textarea);
            textarea.select();

            try {
                document.execCommand('copy');
                linkElement.textContent = '¡Copiado al portapapeles!';
                setTimeout(() => {
                    linkElement.textContent = linkText;
                }, 2000);
            } catch (err) {
                console.error('No se pudo copiar: ', err);
            } finally {
                document.body.removeChild(textarea);
            }
        }


        function closeAllRoleDropdowns() {
            document.querySelectorAll('.role-dropdown-content.show').forEach(dropdown => {
                dropdown.classList.remove('show');
            });
        }

        function toggleRoleDropdown(dropdownId) {
            const dropdown = document.getElementById(dropdownId);
            document.querySelectorAll('.role-dropdown-content.show').forEach(d => {
                if (d.id !== dropdownId) {
                    d.classList.remove('show');
                }
            });
            dropdown.classList.toggle('show');
        }

        function selectRole(memberName, newRole, roleElementId, event) {
            event.preventDefault();

            const roleElement = document.getElementById(roleElementId);
            roleElement.textContent = newRole;

            const dropdownContent = event.target.closest('.role-dropdown-content');
            dropdownContent.classList.remove('show');

            dropdownContent.querySelectorAll('a').forEach(a => {
                a.classList.remove('current-role');
            });
            event.target.classList.add('current-role');

            console.log(`Rol de ${memberName} actualizado a: ${newRole}`);
        }

        function openTaskModal() {            
            if (taskModal) {
                taskModal.style.display = 'flex';
            } else {
                console.error("Error: Elemento 'taskModal' no encontrado.");
            }
        }

        function closeTaskModal() {            
            if (taskModal) {
                taskModal.style.display = 'none';
            }
        }

        window.onload = function () {
            console.log("Tablero Kanban cargado y funcionalidad de modal implementada.");
        };

        window.onclick = function (event) {
            if (event.target == addItemModal) {
                closeAddItemModal();
            } else if (event.target == inviteMemberModal) {
                closeInviteMemberModal();
            } else if (event.target == memberListModal) {
                closeMemberListModal();
            } else if (event.target == addColumnModal) { 
                closeAddColumnModal();
            } else if (event.target == taskModal) {
                closeTaskModal();
            }

            const notificationIcon = document.querySelector('.notification-icon');
            const isClickInsidePopover = notificationPopover.contains(event.target);
            const isClickOnIcon = notificationIcon && notificationIcon.contains(event.target);

            if (isNotificationPopoverOpen && !isClickInsidePopover && !isClickOnIcon) {
                closeNotificationPopover();
            }

            if (memberListModal.style.display === 'flex') {
                if (!event.target.closest('.member-actions')) {
                    closeAllRoleDropdowns();
                }
            }
        }
    </script>


</body>

</html>